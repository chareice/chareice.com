<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on ChengLei's Blog</title><link>https://chareice.com/posts/</link><description>Recent content in Posts on ChengLei's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Tue, 01 Dec 2020 08:09:48 +0800</lastBuildDate><atom:link href="https://chareice.com/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>在Apple M1上运行golang native</title><link>https://chareice.com/posts/apple-m1-golang/</link><pubDate>Tue, 01 Dec 2020 08:09:48 +0800</pubDate><guid>https://chareice.com/posts/apple-m1-golang/</guid><description>Golang对Apple silicon的支持要等到21年2月份，但是现在，可以通过源码编译的方式自行编译Golang来实现对Apple silicon的原生运行。
编译除了需要Apple M1的机器之外，还需要一台已经安装了Go的机器。整体步骤如下： 1. 在已经安装好Go的机器上编译Apple M1的Bootstrap 2. 将编译好的Bootstrap拷贝到Apple M1机器上 3. 在Apple M1机器上使用Bootstrap编译Go
特别提示：由于目前的Go在Apple m1上存在codesigning的问题，有未合并的提交解决了此问题，所以编译需要切换到此提交：https://go-review.googlesource.com/c/go/+/272258/
编译Bootstrap git clone https://go.googlesource.com/go git fetch https://go.googlesource.com/go refs/changes/58/272258/2 &amp;amp;&amp;amp; git checkout -b change-272258 FETCH_HEAD cd go/src GOOS=darwin GOARCH=arm64 ./bootstrap.bash 编译完成后将打包好的go-darwin-arm64-bootstrap.tbz复制到Apple m1机器上。
编译Go 在Apple M1上，解压go-darwin-arm64-bootstrap.tbz，同样clone go的源代码。
git clone https://go.googlesource.com/go git fetch https://go.googlesource.com/go refs/changes/58/272258/2 &amp;amp;&amp;amp; git checkout -b change-272258 FETCH_HEAD ➜ src git:(change-272258) cd src # 这里将GOROOT_BOOTSTRAP替换成你机器上的位置 ➜ src git:(change-272258) GOROOT_BOOTSTRAP=/Users/chareice/Downloads/go-darwin-arm64-bootstrap ./make.bash go-darwin-arm64-bootstrap ./make.bash Building Go cmd/dist using /Users/chareice/Downloads/go-darwin-arm64-bootstrap.</description></item></channel></rss>